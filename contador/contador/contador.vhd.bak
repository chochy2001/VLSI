LIBRARY IEEE;
USE IEEE.STD_LOGIC_1164.ALL;

ENTITY contador IS
	PORT( RST, DIVF: IN STD_LOGIC;
		C, D, U, M: BUFFER INTEGER RANGE 0 TO 9;
		
		SEG: OUT STD_LOGIC_VECTOR(7 DOWNTO 0);
      DIG: OUT STD_LOGIC);
END ENTITY;

ARCHITECTURE prac1 OF contador IS
SIGNAL FREC: INTEGER := 249999;
SIGNAL AUX: INTEGER RANGE 0 TO FREC;
SIGNAL CLK: STD_LOGIC;

BEGIN
	PROCESS(F, INI, M,C,D,U, clk)
	variable hc, hm : integer;
	BEGIN
	IF F='1' then---FORMATO
		hm:=1; 
		HC:=1;
	ELSE 
		hm:=2; 
		HC:=3;
	END IF;
	IF INI='1' THEN---RST EXTERNO
		RST<='1' 
	ELSIF M=HM AND C=HC AND D=5 AND U=9 THEN
		RST<='1';
	ELSE
		RST<='0';
	END IF;
				
	END PROCESS;

	PROCESS(DIVF)
	BEGIN 
		IF RISING_EDGE (DIVF) THEN
			IF AUX = 0 THEN  -- IF AUX = FREC THEN
				CLK <= NOT CLK;
				AUX <= FREC; -- AUX <= 0;
			ELSE
				AUX <= AUX - 1; -- AUX <= AUX + 1;
			END IF;
		END IF;
	END PROCESS;

	DIG <= '0';
	
	WITH COUNT SELECT
		  SEG <= "00000011" WHEN 0, -- 0
					"10011111" WHEN 1, -- 1
					"00100101" WHEN 2, -- 2
					"00001101" WHEN 3, -- 3
					"10011001" WHEN 4, -- 4
					"01001001" WHEN 5, -- 5
					"01000001" WHEN 6, -- 6
					"00011111" WHEN 7, -- 7
					"11111111" WHEN OTHERS;

END prac1;